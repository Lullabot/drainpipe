# DO NOT EDIT THIS FILE
# This file is controlled by Drainpipe, run composer install to apply pending
# updates.  You can add values to the php and solr services adding a file named
# config.drainpipe-override.yml to the .tugboat folder.
#
# Example config.drainpipe-override.yml
# php:
#   aliases:
#   urls:
#   screenshot:
#   visualdiff:
# solr:
#   commands:
#   checkout:
#   depends:
#   volumes:
#   environment:
#   aliases:
#   urls:
services:
  php:
    http: false
    image: {{ services.php.image }}
    default: true
    depends:
{% for item in services.php.depends %}
      - {{ item }}
{% endfor %}
    commands:
      init:
{{ include('php-init.yml.twig')|no_comments|trim|indent(8)|raw }}
      update:
{{ include('php-update.yml.twig')|no_comments|trim|indent(8)|raw }}
      build:
{{ include('php-build.yml.twig')|no_comments|trim|indent(8)|raw }}
      online:
{{ include('php-online.yml.twig')|no_comments|trim|indent(8)|raw }}
{% if services.php.overrides|length > 0 %}
{{ services.php.overrides|yaml_encode|trim|indent(4)|raw }}
{% endif %}

  {{ services.database.type }}:
    image: {{ services.database.image }}
{% if services.database.commands.init|default(false) %}
    commands:
      init:
        - ./.tugboat/scripts/custom-init-command.sh {{ services.database.type }}
{% endif %}
{% if services.memory_cache %}

  {{ services.memory_cache.type }}:
    image: {{ services.memory_cache.image }}
{% if services.memory_cache.commands.init|default(false) %}
    commands:
      init:
        - ./.tugboat/scripts/custom-init-command.sh {{ services.memory_cache.type }}
{% endif %}
{% endif %}
{% if services.search %}

  {{ services.search.type }}:
    image: {{ services.search.image }}
{% if services.search.type == 'solr' and services.search.overrides|length > 0 %}
{{ services.search.overrides|yaml_encode|trim|indent(4)|raw }}
{% endif %}
{% endif %}
